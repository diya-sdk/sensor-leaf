<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../sensor-base/sensor-base.html">
<link rel="import" href="../leaf-scale/leaf-scale.html">

<!--
    TODO(polyup): Inheriting from other custom elements is not yet supported.
    See: https://www.polymer-project.org/1.0/docs/migration.html#inheritance
 -->
<dom-module id="sensor-leaf">
  <style>
			:host{
				display: flex;
				flex-direction: row;
				align-items: center;
				justify-content: space-between;
				font-size: 1.7em;

				overflow: hidden;
			}

			p#label{
				margin: 0px;
				margin-bottom: 20px;
				font-size: 2em;
				color: white;
				text-shadow: 2px 2px #000;
			}

			#sensor{
				display: flex;
				flex-direction: row;
				justify-content: space-between;
				align-items: center;
				width: 100%;
			}
			#icon{
				height: 80%;
			}

		</style>
  <template>

	<p id="label" if="{{_computeLabel(label,icon)}}">{{_computeLabel(label,icon)}}</p>
	<div id="sensor">
	  <img id="icon" src$="{{_computeSrc(icon)}}" if="{{icon}}">
	  <leaf-scale id="scale" leafcount="{{leafCount}}"></leaf-scale>
	</div>


  </template>
</dom-module>
<script>
	Polymer({
		is: 'sensor-leaf',
		properties: {
			leafCount: {
				type: Number,
				value: 4,
				notify: true
			},
			value: { observer: 'valueChanged' },
			min: { readonly: true },
			max: { readonly: true },
			icon: {
				type: String,
				value: null,
				notify: true
			},
			label: {
				type: String,
				value: null,
				notify: true
			}
		},
		behaviors: [DiyaBehaviors.SensorBase],
		ready: function () {
		},
		valueChanged: function () {
			var level = this.value / (this.max - this.min) * this.leafCount;
			this.$.scale.setLevel(level);
		},
		_computeSrc: function (icon) {
			return icon;
		},
		_computeLabel: function (label,icon) {
			if(!icon)
				return label;
			else
				return null;
		}
	});
</script>
