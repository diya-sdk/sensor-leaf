<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../sensor-base/sensor-base.html">
<link rel="import" href="../leaf-scale/leaf-scale.html">

<!--
	TODO(polyup): Inheriting from other custom elements is not yet supported.
	See: https://www.polymer-project.org/1.0/docs/migration.html#inheritance
 -->
<dom-module id="sensor-leaf">
	<template>
		<style>
			:host{
				display: flex;
				flex-direction: row;
				align-items: center;
				justify-content: space-between;
				font-size: 1.7em;
				overflow: hidden;
			}

			p#label{
				margin: 0px;
				margin-bottom: 2%;
				font-size: 2em;
				color: white;
				text-shadow: 2px 2px 10px #555;

				color: var(--sensor-leaf-label-color);
				text-shadow: var(--sensor-leaf-label-text-shadow);
				white-space: var(--sensor-leaf-label-white-space);
			}

			#sensor{
				display: flex;
				/*flex-direction: row;*/
				justify-content: space-between;
				align-items: center;
				width: 100%;
				height: 85%;
				/* keep row by default for the board but take the defined value for the cloud  which needs column for example */
				flex-direction: var(--sensor-leaf-sensor-flex-direction, row);
			}
			#icon{
				height: 100%;
			}
			leaf-scale{
				height: 100%;
			}

			/*//added*/
			/*leaf-scale img{*/
				/*width: 30px;
				height: 35px;
				padding-left: 1px;
				padding-right: 1px;*/

				/*width: var(--sensor-leaf-img-width);
				height: var(--sensor-leaf-img-height);
				padding-left: var(--sensor-leaf-img-padding-left);
				padding-right: var(--sensor-leaf-img-padding-right);*/

				/*--sensor-leaf-img-width: var(--sensor-leaf-img-width);
				--sensor-leaf-img-height: var(--sensor-leaf-img-height);
				--sensor-leaf-img-padding-left: var(--sensor-leaf-img-padding-left);
				--sensor-leaf-img-padding-right: var(--sensor-leaf-img-padding-right);*/
			/*}*/

			/*color: var(--my-toolbar-title-color);*/




		</style>

	<div id="sensor">
	  <template is="dom-if" if="{{displayLabel}}">
		<div>
		  <p id="label">{{_computeLabel(label,icon)}}</p>
		</div>
	  </template>
	  <template is="dom-if" if="{{displayIcon}}">
		<img id="icon" src$="{{_computeSrc(icon)}}" if="{{icon}}">
	  </template>
	  <leaf-scale id="scale" leaf-count="{{leafCount}}"></leaf-scale>
	</div>


  </template>
</dom-module>
<script>
	Polymer({
		is: 'sensor-leaf',
		properties: {
			leafCount: {
				type: Number,
				value: 4,
				notify: true
			},
			value: { observer: 'valueChanged' },
			min: { readonly: true },
			max: { readonly: true },
			icon: {
				type: String,
				value: null,
				notify: true
			},
			label: {
				type: String,
				value: null,
				notify: true
			},
			displayLabel: {
				type: Boolean,
				value: true
			},
			displayIcon: {
				type: Boolean,
				value: false
			}
		},
		behaviors: [DiyaBehaviors.SensorBase],
		ready: function () {
			this.resolution = 0.001;
			this.precision = 3;
		},
		valueChanged: function () {
			var level = this.value / (this.max - this.min) * this.leafCount;
			this.$.scale.setLevel(level);
		},
		_computeSrc: function (icon) {
			return icon;
		},
		_computeLabel: function (label,icon) {
			if(!icon) {
				this.displayLabel=true;
				this.displayIcon=false;
				return label;
			}
			else {
				this.displayLabel=false;
				this.displayIcon=true;
				return "";
			}
		}
	});
</script>
